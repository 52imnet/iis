<form method="POST" action="{{if .ReplyTo}}/reply{{else}}/new{{end}}">
        {{if .CanDelete}}
    <table class="articles" style="width: 100%;margin:1em 0 2em;box-shadow: 0 1px 3px rgba(0, 0, 0,.2);text-align:left">
        <tr class=sep>
            <td>
                <input type=checkbox name=delete-confirm id=delete-confirm>
                <label for=delete-confirm>确认删除该状态，该操作不可逆</label>
            </td>
            <td class=nowrap>
                <button class="gbutton" type=submit name=delete value=1 style="color:#ff5722">删除</a>
            </td>
        </tr>
        <tr>
            <td>
                <input type=checkbox name=nsfw-confirm id=nsfw-confirm {{if .NSFW}}checked{{end}}>
                <label for=nsfw-confirm>标记该状态为NSFW（仅图片）</label>
            </td>
            <td class=nowrap>
                <button class="gbutton" type=submit name=nsfw value=1 style="color:#f90">标记</a>
            </td>
        </tr>
    </table>
        {{end}}

    <table class="articles" style="width: 100%;margin:1em 0;box-shadow: 0 1px 4px rgba(0, 0, 0,.3);position:relative;text-align:left">

        <tr class=sep>
            <td colspan=2 style="padding:0">
                <input type=hidden name=uuid value="{{.UUID}}">
                <textarea
                    id="content"
                    maxlength=1024
                    placeholder="正文"
                    rows={{if .ReplyTo}}6{{else}}10{{end}}
                    name="content"
                    style="padding:0.5em;border:none">{{.Content}}</textarea>
            </td>
        </tr>
        <!-- <tr class=sep id=poll style="display:none">
            <td colspan=2 style="padding:0">
                <div style="display:flex;padding:0.5em;line-height:2.5em;flex-wrap:wrap">
                    <span style="flex:0 10%">#1</span><span style="flex: 0 90%"><input name="poll1" class=t></span>
                    <span style="flex:0 10%">#2</span><span style="flex: 0 90%"><input name="poll2" class=t></span>
                    <span style="flex:0 10%">#3</span><span style="flex: 0 90%"><input name="poll3" class=t></span>
                    <span style="flex:0 10%">#4</span><span style="flex: 0 90%"><input name="poll4" class=t></span>
                    <span style="flex:0 10%">#5</span><span style="flex: 0 90%"><input name="poll5" class=t></span>
                    <span style="flex:0 10%">#6</span><span style="flex: 0 90%"><input name="poll6" class=t></span>
                    <span style="flex:0 10%">#7</span><span style="flex: 0 90%"><input name="poll7" class=t></span>
                    <span style="flex:0 10%">#8</span><span style="flex: 0 90%"><input name="poll8" class=t></span>
                </div>
            </td>
        </tr> -->
        <tr class=sep>
            <td colspan=2>
                <input type=file id=post-image style="display:none" onchange="onImageChanged(this)">
                <input type=hidden id=post-image-base64 name=image64>
                <a class="gbutton" id=post-image-button onclick="sel('#post-image').click()">
                    <span class=icon-picture></span><span class="pic">图片</span>
                </a>
                <input type=checkbox name=nsfw id=nsfw>
                <label for=nsfw>NSFW</label>
                <script>
                    function onImageChanged(el) {
                        sel('#post-image-button .pic').innerText = (el.value.split(/(\\|\/)/g).pop() || "图片").substring(0, 16);
                        sel("#post-image-base64").value = "";

                        if (!el.value) return;

                        var reader = new FileReader();
                        reader.readAsDataURL(el.files[0]);
                        reader.onload = function () {
                            sel("#post-image-base64").value = reader.result;
                            sel("#post-image-button .pic").innerText += " (" + (reader.result.length / 1.33 / 1024).toFixed(0) + "KB)";
                            if (reader.result.length > 2 * 1024 * 1024) {
                                el.value = null;
                                onImageChanged(el);
                                sel('#post-image-button .pic').innerText="图片过大";
                            }
                        };
                    }
                </script>
            </td>
        </tr>
{{if .Error}}
        <tr class=sep style="background:#f1f2f3;cursor:pointer" >
            <td onclick="this.parentNode.style.display='none'" colspan=2>{{template "error_i18n.html" .Error}}</td>
        </tr>
{{end}}
        <tr>
            <td>{{template "emoji.html" .}}</td>
            <td class="nowrap">
                {{if .ReplyTo}}
                <input type=hidden name=reply value="{{.ReplyTo}}">
                <button class="gbutton" type=submit>回复</button>
                {{else}}
                <button class="gbutton" type=submit>发布</button>
                {{end}}
            </td>
        </tr>
    </table>
</form>
