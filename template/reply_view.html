<style>
.gbutton.image {
    height: 120px;
    width: 120px;
    padding: 0;
}

                    .gbutton.image span {
                        display: none;
                    }
                    .gbutton.image img {
                        display: block;
                        max-width: 120px;
                        max-height: 120px;
                        object-fit: contain;
                        border-radius: 3px;
                        margin: auto;
                    }
                    .post-options-emoji img {
                        width: 24px;
                        height: 24px;
                    }
                    .post-options-emoji:hover ul {
                        display: flex;
                        flex-wrap: wrap;
                        width: 250px;
                        height: 250px;
                        overflow-y: scroll;
                    }
                    .post-options-emoji a {
                        text-decoration: none !important;
                    }
                    
</style>

<div id="rv-{{.UUID}}" style="background:white;">
    <table class="articles reply-table" style="border:solid 1px #e1e2e3;border-width:1px 0;position:relative;text-align:left">
        <tr>
            <td style="white-space: nowrap;background:rgba(0,0,0,0.025)" colspan=2>
                <div class="post-options post-options-emoji" onmousemove="emojiMajiang('{{.UUID}}')">
                    <button class=gbutton><i class="icon-emo-devil"></i><i class="icon-down-dir right"></i></button>
                    {{template "emoji.html" .UUID}}
                </div>

                <div class="post-options">
                    <button class=gbutton>图片<span class='image-size'></span><i class="icon-down-dir right"></i></button>
                    <ul style="width: 120px; height: 120px">
                        <!-- Three as a Whole -->
                        <button class=gbutton style="width: 100%; height: 100%" onclick="this.nextElementSibling.click()">
                            <span class=icon-picture></span><span>选择</span>
                        </button>
                        <input type=file style="display:none" onchange="onImageChanged(this)">
                        <input type=hidden name=image64>
                        <!-- Three as a Whole -->
                    </ul>
                </div>

                <div class="post-options">
                    <button class=gbutton>选项<i class="icon-down-dir right"></i></button>
                    <ul>
                        <li>
                            <span onclick="insertTag(this, '{{.UUID}}','[code]','代码块','[/code]')">
                                <i class=icon-code></i>
                                插入 <span style="font-family:monospace">[code][/code]</span>
                            </span>
                        </li>
                        <li>
                            <span onclick="insertTag(this, '{{.UUID}}','[img]','图片URL','[/img]')">
                                <i class=icon-code></i>
                                插入 <span style="font-family:monospace">[img][/img]</span>
                            </span>
                        </li>
                        {{if .ReplyTo}}
                        <li>
                            <span onclick="insertTag(this, '{{.UUID}}', '#ReportThis\n', '举报理由', '')">
                                <i class=icon-police></i>
                                举报该状态
                            </span>
                        </li>
                        <li>
                            <input type=checkbox name=notimeline id="notimeline{{.UUID}}" class=icon-input-checkbox>
                            <i class=icon-ok-circled2></i>
                            <label for="notimeline{{.UUID}}">不同步至我的时间线</label>
                        </li>
                        {{else}}
                        <li>
                            <input type=checkbox name=nomaster id="nomaster{{.UUID}}" class=icon-input-checkbox>
                            <i class=icon-ok-circled2></i>
                            <label for="nomaster{{.UUID}}">不同步至Master时间线</label>
                        </li>
                        <li>
                            <input type=checkbox name=alone id="alone{{.UUID}}" class=icon-input-checkbox>
                            <i class=icon-ok-circled2></i>
                            <label for="alone{{.UUID}}">不同步至我的时间线</label>
                        </li>
                        {{end}}
                        <li>
                            <input type=checkbox name=isnsfw id="isnsfw{{.UUID}}" class=icon-input-checkbox>
                            <i class=icon-ok-circled2></i>
                            <label for="isnsfw{{.UUID}}">
                                标记图片为<span style="color:#f90"><i class='icon-transgender-alt'></i>NSFW</span>
                            </label>
                        </li>
                        <li>
                            <span onclick="$q('#tr-encrypt-{{.UUID}}').style.display = null;hackHide(this)">
                                <i class="icon-code"></i>
                                使用密码加密内容
                            </span>
                        </li>
                    </ul>
                </div>
            </td>
        </tr>

        <tr style="display:none" id="tr-encrypt-{{.UUID}}">
            <td colspan=2>
                <div class=enc-box style="box-shadow:0 0 2px #bbb">
                    <input class=t placeholder="内容" name=enc-content style="border:none;border-right:dotted 1px #ddd;flex:0 66%">
                    <input class=t placeholder="密码 (0~16位)" name=enc-key style="flex:0 33%;border:none" maxlength="16">
                    <button class=gbutton
                            style="flex-shrink: 0"
                            onclick="t=$q('#tr-encrypt-{{.UUID}} input[name=enc-key');$aesgcm().encrypt(
                                          $q('#tr-encrypt-{{.UUID}} input[name=enc-content]').value,
                                          t.value,
                                          function(v) {
                                              if (insertTag(null, '{{.UUID}}', '[enc]', v, '[/enc]') === false) return;
                                              $popup('请记住密码: ' + (t.value || '空'), '#088');
                                              t.value = null;
                                              $q('#tr-encrypt-{{.UUID}}').style.display='none';
                                          })">
                        加密
                    </button>
                </div>
            </td>
        </tr>

        <tr>
            <td style="padding:0" colspan=2>
                <textarea
                    name=content
                    maxlength=1024
                    placeholder="写下你的想法..."
                    rows=6
                    style="padding:0.66em;border:none"></textarea>

                <div
                    style="
                           position: absolute;
                           line-height: 36px;
                           width: 36px;
                           height: 36px;
                           background: #64b5f6;
                           color: white;
                           text-align:center;
                           border-radius: 50%;
                           box-shadow: 0 0 5px #ccc;
                           right: 1em;
                           bottom: 1em;
                           cursor: pointer;
                           font-size: 18px;
                           "
                    onclick="onPost('{{.UUID}}', this, '{{.ReplyTo}}')"
                    onmouseenter="this.style.background='#2196f3'"
                    onmouseout="this.style.background='#64b5f6'"
                    class=icon-comment>
                </div>
            </td>
        </tr>
    </table>
</div>

    <script>
        window.TRIBUTER.attach(document.querySelectorAll("#rv-{{.UUID}} textarea"));
    </script>
