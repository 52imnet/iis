{{template "header.html" .}}

    {{if .ParentArticle}}

        {{if .ParentArticle.Title}}
        <title>{{.ParentArticle.Title}}</title>
        {{else}}
        <title>回复: {{.ParentArticle.DisplayID}}</title>
        {{end}}

        <table class="articles">
            <tr>
                <th>主题: {{.ParentArticle.DisplayID}}</th>
                <th class=nowrap>回复</th>
                <th class=nowrap>作者</th>
                <th class=nowrap>日期</th>
            </tr>
        <tr class=row>
            <td>
                {{template "row_tags.html" .ParentArticle}}
                {{if .ParentArticle.Parent}}<a href="/p/{{.ParentArticle.DisplayParentID}}">上一层</a> /{{end}} 
                {{.ParentArticle.Title}}
            </td>
            <td class=nowrap><span>{{.ParentArticle.Replies}}/{{.ParentArticle.Views}}</span></td>
            <td class=nowrap>
                <a href="/id/{{.ParentArticle.Author}}">{{.ParentArticle.Author}}</a>
                {{if .ShowIP}} / <a href="/ip/{{.ParentArticle.IP}}">{{.ParentArticle.IP}}</a>{{end}}
            </td>
            <td class=nowrap><span>{{.ParentArticle.CreateTimeString}}</span></td>
            </td>
        </tr>
        <tr>
            <td>
                {{if .ParentArticle.Image}}<img class="image" src="{{.ParentArticle.ImageURL}}">{{end}}
                <pre>{{.ParentArticle.ContentHTML}}</pre>
            </td>
            <td class=nowrap style="vertical-align: top"><a href="/new/{{.ParentArticle.DisplayID}}">回复</a></td>
            <td class=nowrap style="vertical-align: top"><a href="/edit/{{.ParentArticle.DisplayID}}">编辑</a></td>
            <td class=nowrap style="vertical-align: top">{{.ParentArticle.ReplyTimeString}}</td>
        </tr>

        {{if len .Articles}}
            {{range .Articles}}
            <tr class=row>
                <td><a href="/p/{{.DisplayID}}">{{.Title}}</a></td>
                <td>{{.Replies}}/{{.Views}}</td> 
                <td class=nowrap><a href="/id/{{.Author}}">{{.Author}}</a>{{if $.ShowIP}} / <a href="/ip/{{.IP}}">{{.IP}}</a>{{end}}</td>
                <td class=nowrap>{{.CreateTimeString}}</td>
            </tr>
            <tr>
                <td colspan=4>
                    <div class=reply>
                        {{if .Image}}<img class="image" src="{{.ImageURL}}">{{end}}
                        <pre>{{.ContentHTML}}</pre>
                    </div>
                </td>
            </tr>
            {{end}}
        {{else}}
            <tr><td colspan=4>无回复</td></tr>
        {{end}}
        </table>

    {{else}}

        <table class="articles">
            <tr>
                {{if eq .Type "inbox"}}
                <title>{{.SearchTerm}}的提醒 {{.Title}}</title>
                <th>
                    {{.SearchTerm}}的提醒 ({{.TotalCount}})
                    <a href="/id/{{.SearchTerm}}">查看{{.SearchTerm}}的回复/新主题
                </th>
                {{else if eq .Type "id"}}
                <title>{{.SearchTerm}}的发言 {{.Title}}</title>
                <th>
                    {{.SearchTerm}}的发言 ({{.TotalCount}})
                    <a href="/inbox/{{.SearchTerm}}">查看谁回复了{{.SearchTerm}}
                </th>
                {{else if eq .Type "ip"}}
                <title>IP: {{.SearchTerm}}的发言 {{.Title}}</title>
                <th>IP: {{.SearchTerm}}的发言 ({{.TotalCount}})</th>
                {{else if eq .Type "tag"}}
                <title>标签: {{.SearchTerm}} {{.Title}}</title>
                <th>标签 ({{.TotalCount}})</th>
                {{else}}
                <title>时间线 {{.Title}}</title>
                <th>标题</th>
                {{end}}
                <th class=nowrap>回复</th>
                <th class=nowrap>作者</th>
                <th class=nowrap>日期</th>
            </tr>
        {{if len .Articles}}
        {{range .Articles}}
        <tr class=row>
            <td>{{template "row_tags.html" .}} <a href="/p/{{.DisplayID}}">{{.Title}}</a></td>
            <td class=nowrap><span>{{.Replies}}/{{.Views}}</span></td>
            <td class=nowrap><a href="/id/{{.Author}}">{{.Author}}</a></td>
            <td class=nowrap><span>{{.CreateTimeString}}</span></td>
        </tr>
        {{if .Parent}}
        <tr>
            <td colspan=4><div class=reply><pre>{{.ContentAbstract}}</pre></div></td>
        </tr>
        {{end}}
        {{end}}
        {{else}}
        <tr><td colspan=4>无内容</td></tr>
        {{end}}
        </table>

    {{end}}

    <hr>
    <div>
        {{if not .NoPrev}}
        [ <a href="?n=0">首页</a> ]
        [ <a href="?n=-{{.Prev}}">上页</a> ]
        {{end}}
        {{if not .NoNext}}
        [ <a href="?n={{.Next}}">下页</a> ]
        [ <a href="?n=-0">末页</a> ]
        {{end}}
    </div>

{{template "footer.html" .}}
