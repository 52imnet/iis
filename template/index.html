{{template "header.html" .}}

    {{if .ParentArticle}}
        <h2>{{.ParentArticle.Title}}</h2>
        {{if .ParentArticle.Title}}
        <title>{{.ParentArticle.Title}}</title>
        {{else}}
        <title>回复: {{.ParentArticle.DisplayID}}</title>
        {{end}}

        <div>
            {{if .ParentArticle.Parent}}
                <a href="/p/{{.ParentArticle.DisplayParentID}}">上一层</a>
            {{else}}
                <a href="/">主页</a>
            {{end}}/
            {{if .ParentArticle.Announcement}}<b>公告</b> / {{end}}
            {{if .ParentArticle.Locked}}<b>锁定</b> / {{end}}
            <a href="/edit/{{.ParentArticle.DisplayID}}">编辑</a> /
            {{.ParentArticle.Replies}} 回复 /
            ID: <a href="/id/{{.ParentArticle.AuthorString}}">{{.ParentArticle.AuthorString}}</a> /
            发布: {{.ParentArticle.CreateTimeString}} /
            最后回复: {{.ParentArticle.ReplyTimeString}}
        </div> 
        <pre>{{.ParentArticle.ContentHTML}}</pre>
        <div>
            {{range .ParentArticle.Tags}}
                <span class=tag><a href="/tag/{{.}}"><b>#</b>{{.}}</a></span>
            {{end}}
        </div>
        <hr>

        {{if len .Articles}}
            {{range .Articles}}
            <div class="row reply">
                <div>
                    &bull; <b>{{.AuthorString}}</b> / {{.CreateTimeString}} /
                    <a href="/p/{{.DisplayID}}">展开{{if .Replies}} ({{.Replies}}){{end}}</a>
                </div>
                <pre>{{.ContentHTML}}</pre>
            </div>
            {{end}}
        {{else}}
            <div>无回复</div>
        {{end}}

    {{else}}

        <div>
            <form action="/search" method="POST">
                <input name=q value="{{.SearchTerm}}">
                <input type=submit value="搜索">
            </form>
            <hr>
        </div>

        <title>{{.Title}}</title>

        {{if len .Articles}}
        {{range .Articles}}
            <div class=row>
                {{range .Tags}}
                <span class=tag><a href="/tag/{{.}}"><b>#</b>{{.}}</a></span>
                {{end}}
                <a href="/p/{{.DisplayID}}">
                    {{if .Announcement}}<b>[公告]</b>{{end}}
                    {{if .Locked}}<b>[锁定]</b>{{end}}
                    {{.Title}}{{if .Replies}} ({{.Replies}}回复){{end}}
                </a>
                &nbsp;<b>{{.AuthorString}}</b> 发布于 {{.CreateTimeString}}
            </div>
        {{end}}
        {{else}}
        <div>无内容</div>
        {{end}}

    {{end}}

    <hr>
    <div>
        {{if not .NoPrev}}
        [ <a href="?n=0">首页</a> ]
        [ <a href="?p={{.Prev}}">上页</a> ]
        {{end}}
        {{if not .NoNext}}
        [ <a href="?n={{.Next}}">下页</a> ]
        [ <a href="?p=-1">末页</a> ]
        {{end}}
        [
        <b>{{if .ParentArticle}}
        <a href="/new/{{.ParentArticle.DisplayID}}">回复</a>
        {{else}}
        <a href="/new/0">新主题</a>
        {{end}}</b>
        ]
    </div>

{{template "footer.html" .}}
