{{template "header.html" .}}

<div style="padding: 0.5em;text-align:center;line-height:2em">
{{if .IsUserTimeline}}
    <title>@{{.User.ID}} 的时间线</title>

    <b>@{{.User.ID}}</b>
            {{if .User.Role}}/ {{.User.Role}}{{end}}
            {{if .User.IsMod}}/ Mod{{end}}
            {{if .User.IsAdmin}}/ 管理员{{end}}
            {{if .User.Banned}}/ 封禁{{end}}
            / {{.User.Followers}} 关注者 
            / {{.User.TotalPosts}} 状态

    {{if .You}}
    <div>
    {{if ne .You.ID .User.ID}}
    <form method="POST" action="/user" style="display:inline-block">
            <input type=hidden name=uuid value="{{.ReplyView.UUID}}">
            <input type=hidden name=username value="{{.You.ID}}">
            <input type=hidden name=method value="follow">
            <input type=hidden name=to value="{{.User.ID}}">
            {{if .IsUserTimelineFollowed}}
            <button class="gbutton" type=submit>取消关注</button>
            {{else}}
            <input type=hidden name=follow value="1">
            <button class="gbutton" type=submit>关注</button>
            {{end}}
    </form>
    <form method="POST" action="/user" style="display:inline-block">
            <input type=hidden name=uuid value="{{.ReplyView.UUID}}">
            <input type=hidden name=username value="{{.You.ID}}">
            <input type=hidden name=method value="block">
            <input type=hidden name=to value="{{.User.ID}}">
            {{if .IsUserTimelineBlocked}}
            <button class="gbutton" type=submit>解除黑名单</button>
            {{else}}
            <input type=hidden name=block value="1">
            <button class="gbutton" type=submit style="color:#f52">拉入黑名单</button>
            {{end}}
    </form>
    {{end}}

    {{if .You.IsAdmin}}
    <a class=gbutton href="/user?as={{.User.ID}}">SWAP</a>
    {{end}}

    {{if .You.IsMod}}
    <form method="POST" action="/user" style="display:inline">
        <input type=hidden name=uuid value="{{.ReplyView.UUID}}">
        <input type=hidden name=method value="ban-user">
        <input type=hidden name=ban value="{{if not .User.Banned}}1{{end}}">
        <input type=hidden name=username value="{{.User.ID}}">
        <button class="gbutton" type=submit>{{if .User.Banned}}解封{{else}}封禁{{end}}</button>
    </form>
    {{end}}

    {{if .ReplyView.Error}}
    <div style="display:inline-block">{{template "error_i18n.html" .ReplyView.Error}}</div>
    {{end}}
    </div>

    {{end}}
{{else if .IsInbox}}
    <b>我的提醒</b>
    <title>我的提醒</title>
{{else if .IsGlobalTimeline}}
    <b>全局时间线</b>
    <title>全局时间线</title>
{{else}}
    {{if .ShowNewPost}}
    <div style="margin-bottom:0.5em">{{template "reply_view.html" .ReplyView}}</div>
    {{end}}

    <title>我的时间线</title>
        <b>我的时间线</b>
        {{if .User.Role}}/ {{.User.Role}}{{end}}
            {{if .User.IsMod}}/ Mod{{end}}
            {{if .User.IsAdmin}}/ 管理员{{end}}
            {{if .User.Banned}}/ 封禁{{end}}
            / {{.User.Followers}} 关注者 
            / <a href="/t/{{.User.ID}}">{{.User.TotalPosts}} 状态</a>
            {{if .User.Unread}}
            / <a class=unread href="/t/:in">{{.User.Unread}} 消息</a>
            {{else}}
            / <a href="/t/:in">{{.User.Unread}} 未读</a>
            {{end}}
            / <a href="/user/followings">我的关注 ({{.User.Followings}})</a>
            / <a href="/user/blacklist">黑名单</a>
{{end}}
</div>

<div class="rows">
    {{if len .Articles}}
    {{range .Articles}}
        {{template "row_content.html" .}}
    {{end}}
    {{else}}
    <div class=row style="text-align:center;padding:1em">无内容</div>
    {{end}}
</div>


<div class=paging>
    <form method="POST">
    <a class=gbutton style="color:#aaa"
    {{if .IsUserTimeline}}
        href="/t/{{.User.ID}}">首页</a>
    {{else if .IsInbox}}
        href="/t/:in">首页</a>
    {{else if .IsGlobalTimeline}}
        href="/master">首页</a>
    {{else}}
        href="/t">首页</a>
    {{end}}

    {{if .Next}}
        <input type=hidden name="cursors" value="{{.Next}}">
        <button type=submit class=gbutton>更多...</button>
    {{end}}

    {{if not .Next}}
        <a class=gbutton style="color:#aaa"
        {{if .IsUserTimeline}}
            href="/t/{{.User.ID}}">没有更多{{.User.ID}}的状态了</a>
        {{else if .IsInbox}}
            href="/t/:in">没有更多提醒了</a>
        {{else if .IsGlobalTimeline}}
            href="/master">没有更多状态了</a>
        {{else}}
            href="/t">没有更多状态了</a>
        {{end}}
    {{end}}
    </form>
</div>
